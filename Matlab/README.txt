We here provide the Matlab implementation of scAIG. 

**DEMOS**
We provide two demos for the usage of scAIG in both clustering and visulization implementations.

In demo_scAIG_C.m, we provide the script for clustering on eight data sets with the output as running time, ACC, NMI and ARI. The other output are saved in the sturct called 'out' as follows.

1. num_cluster: Number of cell classes estimated by scAIG.

2. idx_cell: After removing abnormal cells by scAIG, the index of remaining cell.

3. idx_gene: After scAIG gene selection, the index of remaining genes.

4. nc: Number of connected branches for estimating number of clustering

5. grp: The final clustering result.

6. grps: The clustering result under different number of clustering.

7. Q: The spectrol projection for final clustering.

8. C: The category center obtained when Q is clustered with K-means.

9. D_: The distance matrix generated in the gene selection.

10. A_: The similarity matrix generated in the gene selection.

11. D: The distance matrix generated for clustering.

12. A: The similarity matrix generated for clustering.

If you want to modify the model parameters, you can modify them in options, such as the threshold in gene filtering, the default is [log2(3) 3/2], the number of genes selected each time in gene selection, the default is 100, the proportion of abnormal cells, the default is 5 (means 5%). 

In demo_scAIG_V.m, we provide the script for clustering on eight data sets with the output as the figure of 2D embedding, the clustering accuracy called ARI and the mean silhouette coefficient between 2D embedding and golden label of each data set. The other output are saved in a cell array called Res_Visual_AIG as follows:

1. The first is the origin data as each row represents the expression of a gene on a different cell.

2. The second is the 2D embedding generated by scAIG_V.

3. The third is the golden labels after outlier reduction.

4. The last is the mean silhouette coefficient between the 2D embedding and golden labels.
